<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1.0, user-scalable=0">
	<meta name="format-detection" content="telephone=no">
	<title>Aquarius</title>
	<!--<link rel="stylesheet" href="css/style.css">-->
	{% load static %}
	<link rel="stylesheet" href="{% static 'css/controller.css' %}">
</head>
<body>
<script type="text/javascript">
		var channels_state_json = "{{ channels_state_json }}";
		var channels_state = JSON.parse(channels_state_json);

		function set_channels(page)
		{
			for (var i = 0; i <= 2; i++)
			{
				if (i == page)
				{
					document.getElementById("chns_selector_" + i.toString()).className = "titlef folderon"
				}
				else
				{
					document.getElementById("chns_selector_" + i.toString()).className = "titlef folderoff"
				}
			}
			for (var i = 1; i <= 10; i++)
			{
				let channel_number = page * 10 + i;
				document.getElementById('chn' + i.toString()).innerHTML = "Канал "  + channel_number.toString();

				if (channel_number < channels_state.length)
				{
					var className = "titlev channeloff";
					var classNameMeandr = "meandroff";

					if (channels_state[channel_number - 1])
					{
						className = "titlev channelon";
						classNameMeandr = "meandron";
					}

					document.getElementById('chn' + i.toString() + "_div").className = className;
					document.getElementById('chn' + i.toString() + "_meandr").className = classNameMeandr;
				}
			}
		}

		function set_channels_status()
		{
			for (var i = 0; i <= 2; i++)
			{
				var active_channels = [];
				for (var j = 1; j <= 10; j++)
				{
					let channel_number = i * 10 + j;

					if (channels_state[channel_number - 1])
					{
						active_channels.push(channel_number.toString());
					}

				}
				var active_channels_str = active_channels.join(", ")
				if (active_channels_str == "")
				{
					active_channels_str = "-"
				}

				document.getElementById("chns_selector_" + i.toString() + "_status").innerHTML = active_channels_str;
			}
		}
</script>
	<div class="wrapper">

		<div class="page">
			<div class="page__row">

				<div class="page__element page__head">
				 <div class="mhead">
					<a target="_blank" href="https://hi-garden.ru/" class="mhead__logo xhref">Hi-Garden</a>
					<div class="mhead__title">Aquarius Main</Main></div>
					<a target="_blank" href="https://hi-garden.ru/aqua2-manual" class="mhead__manual xhref">Menu</a>
				 </div>

				</div>

			  <div class="page__element page__body">

				<div class="mbody">

					 <div class="status">

						<div class="status__row">

							<div class="status__column">
								<div class="titlew">&#8986; &nbsp; &nbsp; {{ cont.time|date:"G:i" }}</div>
							</div>

							<div class="status__column">
								<div class="titlew">Следующее<br>включение</div>
							</div>

						</div>

						<div class="status__row">

							<div class="status__column">
								<div class="titlew">MQTT - {% if cont.esp_mqtt %}ОК{% else %}Нет подключения{% endif %}!</div>
							</div>

							<div class="status__column">
								<div class="titlew">&#9200; &nbsp; &nbsp; {{ cont.nearest_time|date:"G:i" }}</div>
							</div>

						</div>


						<div class="status__row">

							<div class="status__column">
								<div class="titlew">
									Aquarius 294<br>Ягодное, Энерг 13
								</div>
							</div>

							<div class="status__column">
								<div class="titlew">
									Канал 2
								</div>
							</div>

						</div>

						<div class="status__row">
							<div class="status__column">
								<div class="titleb">
									<a target="_blank" href="https://hi-garden.ru" class="myxhref">Каналы</a>
								</div>

							</div>
							<div class="status__column">
								<div class="titleb">
									<a target="_blank" href="https://hi-garden.ru" class="myxhref">Ручное</a>
								</div>

							</div>
							<div class="status__column">
								<div class="titleb">
									<a target="_blank" href="https://hi-garden.ru" class="myxhref">Пауза</a>
								</div>

							</div>
						</div>

						<div class="status__row">
							<div class="status__column">
								<div id="chns_selector_0" class="titlef folderon">
									<a  onClick="javascript:set_channels(0);" role="button" href="#" class="myxhref">Каналы 1-10<br></a>
									<div id="chns_selector_0_status" class="chnon">1, 7, 10</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chns_selector_1" class="titlef folderoff">
									<a onClick="javascript:set_channels(1);" role="button" href="#" class="myxhref">Каналы 11-20<br></a>
									<div id="chns_selector_1_status" class="chnon">11, 14, 19</div>
								</div>

							</div>

							<div class="status__column">
								<div id="chns_selector_2" class="titlef folderoff">
									<a onClick="javascript:set_channels(2);" role="button" href="#" class="myxhref">Каналы 21-30<br></a>
									<div id="chns_selector_2_status" class="chnon">-</div>
								</div>

							</div>

						</div>

						<div id="chns_1-10">
						<div class="status__row">

							<div class="status__column">
								<div id="chn1_div" class="titlev channelon">
									<a id="chn1" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 1</a>
									<div id="chn1_meandr" class="meandron">_∏_∏_</div>
								</div>

							</div>

							<div class="status__column">
								<div id="chn2_div" class="titlev channeloff">
									<a id="chn2" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 2</a>
									<div id="chn2_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn3_div" class="titlev channeloff">
									<a id="chn3" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 3</a>
									<div id="chn3_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn4_div" class="titlev channeloff">
									<a id="chn4" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 4</a>
									<div id="chn4_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

						</div>

						<div class="status__row">

							<div class="status__column">
								<div id="chn5_div" class="titlev channeloff">
									<a id="chn5" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 5</a>
									<div id="chn5_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn6_div" class="titlev channeloff">
									<a id="chn6" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 6</a>
									<div id="chn6_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn7_div" class="titlev channeloff">
									<a id="chn7" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 7</a>
									<div id="chn7_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn8_div" class="titlev channeloff">
									<a id="chn8" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 8</a>
									<div id="chn8_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

						</div>

						<div class="status__row">

							<div class="status__column">
								<div class="titlev onledw">
									<a target="_blank" href="https://hi-garden.ru" class="myxhref">Влажность</a>
									<div class="meandron">45%</div>
								</div>

							</div>

							<div class="status__column">
								<div id="chn9_div" class="titlev channeloff">
									<a id="chn9" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 9</a>
									<div id="chn9_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div id="chn10_div" class="titlev channeloff">
									<a id="chn10" target="_blank" href="https://hi-garden.ru" class="myxhref">Канал 10</a>
									<div id="chn10_meandr" class="meandroff">_∏_∏_</div>
								</div>
							</div>

							<div class="status__column">
								<div class="titlev channeloff">
									<a target="_blank" href="https://hi-garden.ru" class="myxhref">Насос</a>
									<div class="meandroff">&nbsp;</div>
								</div>

							</div>

						</div>
							</div>

						<div class="status__row">

							<div class="status__column">
								<div class="imgsm">
									{% load static %}
									<img src="{% static 'img/pressw.png' %}" width="80%"  alt="">
								</div>

								<div class="titlew">2,5</div>
							</div>

							<div class="status__column">
								<div class="imgsm">
									<img src="{% static 'img/potok.png' %}" width="80%"  alt="">
								</div>
								<div class="titlew">{{ cont.pressure }}</div>
							</div>

							<div class="status__column">
								<div class="imgsm">
									<img src="{% static 'img/tankf.png' %}" width="75%"  alt="">
								</div>
								<div class="titlew">ON</div>
							</div>

							<div class="status__column">
								<div class="imgsm">
									<img src="{% static 'img/measure.png' %}" width="80%"  alt="">
								</div>
								<div class="titlew">{{ cont.t1 }}° {{ cont.t2 }}°</div>
							</div>

						</div>

						<div class="status__row">

							<div class="status__column">
								<div class="titlew">Esp: {{ cont.esp_v }}</div>
							</div>

							<div class="status__column">
								<div class="titlew">And: site</div>
							</div>

							<div class="status__column">
								<div class="titlew">Avr: 159</div>
							</div>

						</div>
					</div>

				 </div>
			  </div>

			  <div class="page__element page__footer">
				<div class="fcontent">
					<a target="_blank" href="https://hi-garden.ru/" class="mhead__manual xhref">Контроллеры орошения</a>
				</div>
			  </div>
			</div>
	</div>
		<script type="text/javascript">
			set_channels(0);
			set_channels_status();
		</script>
</body>
</html>